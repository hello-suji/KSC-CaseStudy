## ğŸ§ª Case Study: Composite-Goal LLM-based Test Generation

---

### 0ï¸âƒ£ ì „ì²´ ì‹¤í—˜ í™˜ê²½

* **ì‹¤í–‰ í”Œë«í¼:** Google Colab (Ubuntu 22.04, Python 3.10.12)
* **í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬:** pytest 7.4.4 / coverage.py 7.6.1
* **ì»¤ë²„ë¦¬ì§€ ë‹¨ìœ„:** SlipCover(Altmayer Pizzorno & Berger 2023) ê¸°ì¤€ì˜ ë¼ì¸Â·ë¶„ê¸° ë‹¨ìœ„
* **ëª¨ë¸:** GPT-4o-2024-05-13 (temperature = 0, deterministic mode)
* **ëŒ€ìƒ í”„ë¡œì íŠ¸:** Temporal money-transfer-project-template-python
* **ì‚°ì¶œë¬¼ ê²½ë¡œ:**

  ```
  run_artifacts/run1/
  â”œâ”€â”€ coverage.json
  â”œâ”€â”€ module_breakdown.json
  â”œâ”€â”€ cov_shards/.coverage.*
  â”œâ”€â”€ logs/
  â””â”€â”€ generated_tests/
  ```

---

### 1ï¸âƒ£ ë‹¨ê³„ë³„ êµ¬ì„± ìš”ì•½

|  ë‹¨ê³„ | ì´ë¦„               | ì£¼ìš” ë‚´ìš©                                      |
| :-: | :--------------- | :----------------------------------------- |
| 3-0 | í™˜ê²½ ì´ˆê¸°í™”           | ì˜ì¡´ì„± ì„¤ì¹˜, `.coveragerc` ìƒì„± ë° ìŠ¤ì½”í”„ ê³ ì •          |
| 3-1 | ê¸°ì¤€ì„  ì¸¡ì •           | ê¸°ì¡´ PyTest í…ŒìŠ¤íŠ¸ ì‹¤í–‰ â†’ `.coverage.baseline` ì €ì¥ |
| 3-2 | ë³µí•© ëª©í‘œ ìƒì„±         | AST ë¶„ì„ â†’ ë¶„ê¸°Â·ì •ì˜â€“ì‚¬ìš©Â·ì˜ˆì™¸ ê²½ë¡œ ì¶”ì¶œ ë° ëª©í‘œ êµ¬ì¡°í™”        |
| 3-3 | ì´ˆê¸° í…ŒìŠ¤íŠ¸ í”„ë¡¬í”„íŠ¸ ìƒì„±   | ì‹œìŠ¤í…œ/ì‚¬ìš©ì ì§€ì‹œë¶€ ì´ì›í™” â†’ LLM í…ŒìŠ¤íŠ¸ ì½”ë“œ ìƒì„±            |
| 3-5 | í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° ì»¤ë²„ë¦¬ì§€ ìˆ˜ì§‘ | ìƒì„± í…ŒìŠ¤íŠ¸ ì‹¤í–‰ â†’ coverage shard ì €ì¥              |
| 3-6 | ë³´ê°• í”„ë¡¬í”„íŠ¸ ìƒì„±       | ë¯¸ë„ë‹¬ ëª©í‘œ ì„ ë³„ â†’ ë³´ê°•ìš© ì…ë ¥ ì‘ì„± ë° ë°°ì¹˜í™”                |
| 3-7 | í”¼ë“œë°± ë¼ìš´ë“œ          | Adaptive Refinement ë°˜ë³µ ìˆ˜í–‰                  |
| 3-8 | ê²°ê³¼ ê²°í•©            | ëª¨ë“  shard ê²°í•© â†’ ìµœì¢… ì»¤ë²„ë¦¬ì§€ ì‚°ì¶œ                   |

---

### 2ï¸âƒ£ í”„ë¡¬í”„íŠ¸ ì„¤ê³„

---

#### (1) 3-3 ì´ˆê¸° í…ŒìŠ¤íŠ¸ ìƒì„± í”„ë¡¬í”„íŠ¸

| ì§€ì‹œë¶€ êµ¬ë¶„      | ì—­í•  ìš”ì•½                                                                                                                                                                                                                                                       | ì˜ˆì‹œ í”„ë¡¬í”„íŠ¸ ë¬¸                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| :---------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **ì‹œìŠ¤í…œ ì§€ì‹œë¶€** | â€¢ ëª¨ë¸ì˜ ì—­í• ì„ í…ŒìŠ¤íŠ¸ ì½”ë“œ ìƒì„±ê¸°ë¡œ í•œì •<br>â€¢ ì¶œë ¥ì€ ë‹¨ì¼ JSON ê°ì²´ë¡œ ê°•ì œ<br>â€¢ ì½”ë“œ ìˆ˜ì • ê¸ˆì§€, `importlib` + `getattr`ë¡œ ëª¨ë“ˆ ì ‘ê·¼<br>â€¢ ì‹¬ë³¼ ì—†ì„ ë•Œë§Œ ê°€ë“œí˜• `pytest.skip` í—ˆìš©<br>â€¢ ê° í…ŒìŠ¤íŠ¸ì— `assert` ë˜ëŠ” `pytest.raises()` í•„ìˆ˜<br>â€¢ ì™¸ë¶€ ì ‘ê·¼(mock/monkeypatch)ìœ¼ë¡œ ëŒ€ì²´<br>â€¢ ë¶„ê¸°Â·ì •ì˜â€“ì‚¬ìš©Â·ì˜ˆì™¸ ê²½ë¡œ ëª¨ë‘ ê²€ì¦<br>â€¢ ì „ì—­ ìƒíƒœ ë³€ê²½ ê¸ˆì§€ | `ì—­í• : ë‹¹ì‹ ì€ ì£¼ì–´ì§„ ëª©í‘œ(ë¶„ê¸°/ì •ì˜-ì‚¬ìš©/ì˜ˆì™¸)ë¥¼ ì‹¤ì œë¡œ ì‹¤í–‰í•˜ëŠ” PyTest í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ìƒì„±í•˜ëŠ” í…ŒìŠ¤íŠ¸ ìƒì„±ê¸°ì…ë‹ˆë‹¤.\nì¶œë ¥ í˜•ì‹: ë§ˆí¬ë‹¤ìš´ ì—†ì´ í•˜ë‚˜ì˜ JSON ê°ì²´ë¡œë§Œ ì‘ë‹µí•˜ì„¸ìš”.\nì¶œë ¥ ìŠ¤í‚¤ë§ˆ: {"filename":"test_*.py","tests":[{"name":"test_*","code":"<pytest í…ŒìŠ¤íŠ¸ ì½”ë“œ>"}]}\ní–‰ë™ ì œì•½:\nâ€¢ ì›ë³¸ ì½”ë“œ ìˆ˜ì • ê¸ˆì§€\nâ€¢ importlibë¡œ ëª¨ë“ˆ ë¡œë“œ í›„ getattrë¡œ ì‹¬ë³¼ ì ‘ê·¼\nâ€¢ ì‹¬ë³¼ ì—†ì„ ë•Œë§Œ pytest.skip('symbol missing') í—ˆìš©\nâ€¢ ê° í…ŒìŠ¤íŠ¸ëŠ” assert ë˜ëŠ” pytest.raises(...) í¬í•¨\nâ€¢ ì™¸ë¶€ ì ‘ê·¼ì€ mock/monkeypatchë¡œ ëŒ€ì²´\nâ€¢ ë¶„ê¸°/ì •ì˜â€“ì‚¬ìš©/ì˜ˆì™¸ ê²½ë¡œ ê²€ì¦\nâ€¢ ì „ì—­ ìƒíƒœ ì”ì¡´ ê¸ˆì§€`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **ì‚¬ìš©ì ì§€ì‹œë¶€** | â€¢ ëª©í‘œë³„ IDÂ·ìš°ì„ ìˆœìœ„(rank/priority) ì „ë‹¬<br>â€¢ í”„ë¡œì íŠ¸ ë£¨íŠ¸Â·ëª¨ë“ˆ ì •ë³´ ì œê³µ<br>â€¢ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ íŒŒì¼Â·í•¨ìˆ˜Â·íƒ€ê¹ƒ ë¼ì¸ ëª…ì‹œ<br>â€¢ ì‹¤í–‰Â·assert ì •ì±… ë° ê²©ë¦¬ ê·œì¹™ ì •ì˜<br>â€¢ mock ê³„íšÂ·ì˜ˆì™¸ íŒíŠ¸ í¬í•¨<br>â€¢ í…ŒìŠ¤íŠ¸ ìƒì„± ì ˆì°¨(scaffolding)ì™€ ì‹¤í–‰ ì§€ì¹¨ ì œê³µ                                                                                   | `{"schema_version":"v1","identifier":{"id":"0001","rank":1,"priority":4.3,"basis":"coverage_gain"},"project":{"root":"/workspace/proj","module":"pkg.workflows"},"goal":{"file":"pkg/workflows.py","function":{"name":"refund","lineno":120},"components":{"branches":[...],"def_uses":[...],"exceptions":[...]}, "target_lines":[121,128,135]},"constraints":{"import_policy":{"strategy":"importlib_only","on_missing":"pytest.skip"},"isolation_policy":{"no_fs_no_net":true,"patch_time":true,"forbid_asyncio_run":true,"patch_env":true},"execution_contract":{"must_hit_at_least_n_target_lines":1},"assert_policy":{"prefer_pytest_raises":true,"prefer_explicit_asserts":true}},"hints":{"needs_mock":true,"mock_plan":["datetime_now","time_sleep","env_access"],"exception_hint":[{"type":"ValueError","lines":[134,135]}]},"scaffolding":["1) importlibë¡œ ëª¨ë“ˆ ë¡œë“œ","2) ì…ë ¥ ë²¡í„° êµ¬ì„±","3) ì™¸ë¶€ ì˜ì¡´ monkeypatch","4) target_lines ì‹¤í–‰","5) assert ì‘ì„±","6) í…ŒìŠ¤íŠ¸ëª… hits_L<line> í¬í•¨"],"instructions":["ê° í…ŒìŠ¤íŠ¸ëŠ” target_lines ì¤‘ ìµœì†Œ 1ì¤„ ì‹¤í–‰","ë¶„ê¸° ì–‘ ê²½ë¡œ ê²€ì¦","ì •ì˜â€“ì‚¬ìš© íš¨ê³¼ ê²€ì¦","ì˜ˆì™¸ íƒ€ì…Â·ë©”ì‹œì§€ ê²€ì¦","ê°€ë“œí˜• skip ì™¸ skip ê¸ˆì§€"]}` |


**í•µì‹¬ íŠ¹ì§•**

* **ì‹œìŠ¤í…œ ì§€ì‹œë¶€**ê°€ í˜•ì‹ê³¼ ì—­í• ì„ ì—„ê²©íˆ ê³ ì • â†’ ë¹„ì •í˜• ì¶œë ¥ ì°¨ë‹¨
* **ì‚¬ìš©ì ì§€ì‹œë¶€**ê°€ êµ¬ì²´ì  ì½”ë“œ ê²½ë¡œÂ·mock ê³„íšÂ·ê²€ì¦ ì •ì±… ì œê³µ
* **mock_plan** ìœ¼ë¡œ ì‹œê°„, í™˜ê²½, ë¹„ë™ê¸°, ë„¤íŠ¸ì›Œí¬ ì˜ì¡´ì„± ì œê±°
* **execution_contract** ë¡œ í…ŒìŠ¤íŠ¸ ìœ íš¨ì„± ìë™ ê²€ì¦ ê°€ëŠ¥

---

#### (2) 3-6 ë³´ê°•ìš© í”„ë¡¬í”„íŠ¸

**ëª©ì :** coverage_gen ê²°ê³¼ ê¸°ì¤€ìœ¼ë¡œ ë¯¸ë„ë‹¬ ëª©í‘œë¥¼ ì„ ë³„í•˜ê³  í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ë³´ì •

| ì§€ì‹œë¶€ êµ¬ë¶„      | ì—­í•  ìš”ì•½                                                                                                                                                                                                                                                           | ì˜ˆì‹œ í”„ë¡¬í”„íŠ¸ ë¬¸                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| :---------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ì‹œìŠ¤í…œ ì§€ì‹œë¶€** | â€¢ ê¸°ì¡´ í…ŒìŠ¤íŠ¸ë¥¼ ë³´ê°•í•´ ë¯¸ì»¤ë²„ ë¼ì¸ ë„ë‹¬ ìœ ë„<br>â€¢ ì¶œë ¥ì€ JSON edits ê°ì²´ë¡œ ê°•ì œ<br>â€¢ í…ŒìŠ¤íŠ¸ êµ¬ì¡° ìœ ì§€, ì…ë ¥Â·ê²½ê³„Â·í˜¸ì¶œ ìˆœì„œ ì¡°ì •<br>â€¢ ì™¸ë¶€ ë¶€ì‘ìš© ê¸ˆì§€(mock/monkeypatch ì‚¬ìš©)<br>â€¢ `importlib` + `getattr` ìœ ì§€<br>â€¢ ê°€ë“œí˜• skip ì™¸ skip ê¸ˆì§€<br>â€¢ ê° í…ŒìŠ¤íŠ¸ëŠ” ìµœì†Œ 1ì¤„ ì‹¤í–‰ + assert/pytest.raises í¬í•¨<br>â€¢ í…ŒìŠ¤íŠ¸ëª…ì— `hits_L<line>` í¬í•¨ ê¶Œì¥ | `ë‹¹ì‹ ì€ ê¸°ì¡´ pytest í…ŒìŠ¤íŠ¸ë¥¼ ë³´ê°•í•˜ì—¬ ë¯¸ì»¤ë²„ ì˜ì—­(Target Lines)ì— ë„ë‹¬í•˜ë„ë¡ ìˆ˜ì •í•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤.\nì¶œë ¥ì€ í•˜ë‚˜ì˜ JSON ê°ì²´ { "edits":[{"id":"<goal_id::filename>","new_code":"<ë³´ê°•ëœ pytest í…ŒìŠ¤íŠ¸ ì½”ë“œ>"}] } í˜•ì‹ìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.\nì§€ì¹¨:\nâ€¢ í…ŒìŠ¤íŠ¸ êµ¬ì¡° ìœ ì§€\nâ€¢ ì…ë ¥/ê²½ê³„ì¡°ê±´/í˜¸ì¶œ ìˆœì„œ ì¡°ì •\nâ€¢ still_missing_target_lines ë„ë‹¬\nâ€¢ ì™¸ë¶€ ë¶€ì‘ìš© ê¸ˆì§€\nâ€¢ importlib + getattr ìœ ì§€\nâ€¢ ê°€ë“œí˜• skip ì™¸ skip ê¸ˆì§€\nâ€¢ ê° í…ŒìŠ¤íŠ¸ 1ì¤„ ì´ìƒ ì‹¤í–‰ ë° assert/pytest.raises í¬í•¨\nâ€¢ í…ŒìŠ¤íŠ¸ëª… hits_L<line> í¬í•¨`                                                                                                                                                                                                                                                                         |
| **ì‚¬ìš©ì ì§€ì‹œë¶€** | â€¢ ë¼ìš´ë“œ ë©”íƒ€ë°ì´í„°(ì´ë¦„Â·íŒŒë¼ë¯¸í„°) ì œê³µ<br>â€¢ ì „ì—­ ë¯¸ì»¤ë²„ ë¼ì¸ ìš”ì•½(top missing files) ì „ë‹¬<br>â€¢ ë³´ê°• ëŒ€ìƒ í…ŒìŠ¤íŠ¸ ë° near-miss ì—¬ë¶€ í¬í•¨<br>â€¢ ê¸°ì¡´ ì½”ë“œÂ·ë¡œê·¸Â·ë¯¸ë„ë‹¬ ë¼ì¸ ì°¨ì´ ì „ë‹¬<br>â€¢ batch ë‹¨ìœ„ë¡œ LLMì— ì „ë‹¬ (ë™ì¼ íŒŒì¼ ì¶©ëŒ ë°©ì§€)                                                                                                | `{"schema_version":"refine-v1","round_dir":"refine_round1","selection_params":{"near_miss_window":2,"batch_size":3,"max_rounds":5},"global_uncovered":{"total_missing_lines":147,"top_files":[{"file":"pkg/activities.py","missing_count":38,"missing_lines":[...]}]},"batch_index":1,"tests":[{"id":"0007::test_gen_0007_workflows_refund.py","target_file":"pkg/workflows.py","target_lines":[121,128,135],"near_miss":true,"uncovered_diff":{"still_missing_target_lines":[128,135],"file_uncovered_lines_baseline":[...],"file_uncovered_remaining_gen":[...]},"run":{"stdout_head":"<ë¡œê·¸>","stderr_head":"<ì—ëŸ¬>"},"original_test_code":"<ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ì½”ë“œ>"}]}` |
   

**í•µì‹¬ íŠ¹ì§•**

* **ë¯¸ë„ë‹¬ íŒì • ê¸°ì¤€:** target_lines í•˜ë‚˜ë„ ë„ë‹¬ ëª»í•œ goalë§Œ ì„ íƒ
* **near-miss íŒì •:** Â±2 ë¼ì¸ ì´ë‚´ ì‹¤í–‰ ì‹œ ë³´ê°• ìš°ì„ ìˆœìœ„ ë¶€ì—¬
* **uncovered_diff:** ê¸°ì¤€ì„  ëŒ€ë¹„ ì”ì—¬ ë¯¸ì»¤ë²„ ë¼ì¸ ì •ë³´ ì œê³µ
* **original_test_code + ì‹¤í–‰ ë¡œê·¸ ì£¼ì…:** ìˆ˜ì • ì°¸ì¡° ìë£Œ ì œê³µ
* **íŒŒì¼ë³„ ë°°ì¹˜ ë‹¨ìœ„ ë³´ê°•:** ë™ì¼ íŒŒì¼ ì¶©ëŒ ë°©ì§€
* **ì¶œë ¥:** `edits` ë°°ì—´ â†’ ê° í•­ëª©ì˜ `new_code` ë¡œ íŒŒì¼ ê°±ì‹  ì¦‰ì‹œ ê°€ëŠ¥

---

### 3ï¸âƒ£ ìµœì¢… ê²°ê³¼ ìš”ì•½

| êµ¬ë¶„           | PyTest (ê¸°ì¤€ì„ ) | ë³¸ ì—°êµ¬ (ìµœì¢…) |        í–¥ìƒí­ |
| :----------- | -----------: | --------: | ---------: |
| ë¼ì¸ ì»¤ë²„ë¦¬ì§€      |      65.38 % |   75.00 % |  +9.62 % p |
| ë¶„ê¸° ì»¤ë²„ë¦¬ì§€      |      60.00 % |   80.00 % | +20.00 % p |
| ì •ì˜â€“ì‚¬ìš© ì²´ì¸ ë‹¬ì„±ë¥  |       0.00 % |   20.00 % | +20.00 % p |
| ì˜ˆì™¸ ê²½ë¡œ ë‹¬ì„±ë¥     |       0.00 % |   20.00 % | +20.00 % p |

**í•µì‹¬ ê´€ì°°**

* `run_worker`, `run_workflow` ëª¨ë“ˆì—ì„œ ìƒˆë¡œìš´ ë¶„ê¸°Â·ì˜ˆì™¸ ê²½ë¡œ ë„ë‹¬
* 3-3 í”„ë¡¬í”„íŠ¸ â†’ ì´ˆê¸° í…ŒìŠ¤íŠ¸ í’ˆì§ˆ ë° êµ¬ì¡°ì  ê²€ì¦ ë³´ì¥
* 3-6 í”„ë¡¬í”„íŠ¸ â†’ ë¯¸ë„ë‹¬ ë¼ì¸ ë³´ê°• ë° ë„ë‹¬ë¥  ìƒìŠ¹ íš¨ê³¼
* ë°˜ë³µ ë¼ìš´ë“œ í‰ê·  3íšŒ ì´ë‚´ ìˆ˜ë ´ â†’ CoverUp(2025) ìœ ì‚¬ ê²½í–¥
* ë³µí•© ëª©í‘œ ê°€ì¤‘ì¹˜ Î»â‚ = Î»â‚‚ > Î»â‚ƒ ì„¤ì •ì´ ê°€ì¥ ì•ˆì •ì  ê²°ê³¼

